# metab
norm_wmean_metab_sep <- run_wmean(mat = logFC_PEA_metab_z, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_metab_sep <- norm_wmean_metab_sep %>%
filter(statistic == 'norm_wmean')
# prot
norm_wmean_prot_MTBE_sep <- run_wmean(mat = logFC_PEA_prot_MTBE_z, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_prot_MTBE_sep <- norm_wmean_prot_MTBE_sep %>%
filter(statistic == 'norm_wmean')
norm_wmean_prot_autoSP3_sep <- run_wmean(mat = logFC_PEA_prot_autoSP3_z, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_prot_autoSP3_sep <- norm_wmean_prot_autoSP3_sep %>%
filter(statistic == 'norm_wmean')
# Chunk 8
corr_matrix_MTBE_sep <- norm_wmean_prot_MTBE_sep[,c(3,2,4)]
corr_matrix_MTBE_sep <- pivot_wider(corr_matrix_MTBE_sep, names_from = condition, values_from = score )
corr_matrix_MTBE_sep <- corr_matrix_MTBE_sep %>%
column_to_rownames("source")
corr_matrix_autoSP3_sep <- norm_wmean_prot_autoSP3_sep[,c(3,2,4)]
corr_matrix_autoSP3_sep <- pivot_wider(corr_matrix_autoSP3_sep, names_from = condition, values_from = score )
corr_matrix_autoSP3_sep <- corr_matrix_autoSP3_sep %>%
column_to_rownames("source")
corr_proteomics <- diag(cor(corr_matrix_MTBE_sep, corr_matrix_autoSP3_sep, method= "pearson"))
## correlation sample wise
corr_proteomics
mean_corr_proteomics <- mean(corr_proteomics)
mean_corr_proteomics
# Chunk 9
matrix_metab <- norm_wmean_metab_sep[,c(3,2,4)]
matrix_metab <- pivot_wider(matrix_metab, names_from = condition, values_from = score )
matrix_MTBE <- norm_wmean_prot_MTBE_sep[,c(3,2,4)]
matrix_MTBE <- pivot_wider(matrix_MTBE, names_from = condition, values_from = score )
matrix_autoSP3 <- norm_wmean_prot_autoSP3_sep[,c(3,2,4)]
matrix_autoSP3 <- pivot_wider(matrix_autoSP3, names_from = condition, values_from = score )
# filtering of same pathways between metab and MTBE, autoSP3 respectively
subset_corr <- which(matrix_metab$source %in% matrix_MTBE$source)
source_subset <- matrix_metab$source[subset_corr]
matrix_metab <- matrix_metab[subset_corr,]
matrix_metab <- matrix_metab %>%
column_to_rownames("source")
matrix_MTBE <- matrix_MTBE[which(matrix_MTBE$source %in% source_subset),]
matrix_MTBE <- matrix_MTBE %>%
column_to_rownames("source")
matrix_autoSP3 <- matrix_autoSP3[which(matrix_autoSP3$source %in% source_subset),]
matrix_autoSP3 <- matrix_autoSP3 %>%
column_to_rownames("source")
# Chunk 10
# average metab and proteomics (prot1, prot2 respectively)
corr_matrix_MTBE_metab <- list(matrix_metab, matrix_MTBE)
corr_matrix_MTBE_metab_avg <- Reduce("+",corr_matrix_MTBE_metab)/length(corr_matrix_MTBE_metab)
corr_matrix_autoSP3_metab <- list(matrix_metab, matrix_autoSP3)
corr_matrix_autoSP3_metab_avg <- Reduce("+",corr_matrix_autoSP3_metab)/length(corr_matrix_autoSP3_metab)
# Chunk 11
corr_integrated_average <- diag(cor(corr_matrix_MTBE_metab_avg, corr_matrix_autoSP3_metab_avg, method ="pearson"))
corr_integrated_average
mean_corr_integrated_average<- mean(corr_integrated_average)
mean_corr_integrated_average
# Chunk 12
ph_corr <- matrix(NA, ncol = 3, nrow=5)
colnames(ph_corr) <- c("Proteomics", "Integrated", "Integrated Average")
rownames(ph_corr) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr[c(1:4),1] <- corr_proteomics
ph_corr[5,1] <- mean_corr_proteomics
ph_corr[c(1:4),2] <- corr_integrated
ph_corr[5,2] <- mean_corr_integrated
ph_corr[c(1:4),3] <- corr_integrated_average
ph_corr[5,3] <- mean_corr_integrated_average
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
pdf("pHeatmap_pathway_enrichment_scores_correlation.pdf")
heatmap_plot
dev.off()
# Chunk 13
# metab and MTBE
corr_metab_MTBE <- diag(cor(matrix_metab, matrix_MTBE, method= "pearson"))
## correlation sample wise
corr_metab_MTBE
mean_corr_metab_MTBE <- mean(corr_metab_MTBE)
mean_corr_metab_MTBE
# metab and autoSP3
corr_metab_autoSP3 <- diag(cor(matrix_metab, matrix_autoSP3, method= "pearson"))
## correlation sample wise
corr_metab_autoSP3
mean_corr_metab_autoSP3 <- mean(corr_metab_autoSP3)
mean_corr_metab_autoSP3
# Chunk 14
ph_corr_m <- matrix(NA, ncol = 2, nrow=5)
colnames(ph_corr_m) <- c("Metab and MTBE", "Metab and autoSP3")
rownames(ph_corr_m) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr_m[c(1:4),1] <- corr_metab_MTBE
ph_corr_m[5,1] <- mean_corr_metab_MTBE
ph_corr_m[c(1:4),2] <- corr_metab_autoSP3
ph_corr_m[5,2] <- mean_corr_metab_autoSP3
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
corr_metab_MTBE
# metab and MTBE
corr_metab_MTBE <- diag(cor(matrix_metab, matrix_MTBE, method= "pearson"))
## correlation sample wise
corr_metab_MTBE
View(matrix_metab)
View(norm_wmean_metab_sep)
# metab
norm_wmean_metab_sep <- run_wmean(mat = logFC_PEA_metab_z, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_metab_sep <- norm_wmean_metab_sep %>%
filter(statistic == 'norm_wmean')
View(norm_wmean_metab_sep)
View(logFC_PEA_metab_z)
library(decoupleR)
library(readr)
library(readxl)
library(dplyr)
library(tibble)
library(tidyr)
library(pheatmap)
library(ggplot2)
library(ComplexHeatmap)
# network combined
combined_metab_gene_hallmarks <- read_csv("../support/combined_metab_gene_hallmarks.csv")
network_combined <- combined_metab_gene_hallmarks
network_combined$mor <- 1
network_combined$term <- gsub("HALLMARK_","", network_combined$term)
network_combined$term <- gsub("_", " ", network_combined$term)
# network separated
network_met <- network_combined[which(grepl("HMDB", network_combined$feature) == T),]
network_prot <- network_combined[which(grepl("HMDB", network_combined$feature) == F),]
# input for pathway enrichment analysis
logFC_PEA_prot_MTBE_z <- readRDS("../results/single_patient/logFC_PEA_prot_MTBE_z.Rda")
logFC_PEA_prot_autoSP3_z <- readRDS("../results/single_patient/logFC_PEA_prot_autoSP3_z.Rda")
logFC_PEA_metab_z <- readRDS("../results/single_patient/logFC_PEA_metab_z.Rda")
Biocrates_metabolite_identifier <- read_excel("../support/Biocrates_metabolite_identifier.xlsx")
Biocrates_metabolite_identifier$feature <- gsub("[()/: -]",".",Biocrates_metabolite_identifier$feature)
library(decoupleR)
library(readr)
library(readxl)
library(dplyr)
library(tibble)
library(tidyr)
library(pheatmap)
library(ggplot2)
library(ComplexHeatmap)
# network combined
combined_metab_gene_hallmarks <- read_csv("../support/combined_metab_gene_hallmarks.csv")
network_combined <- combined_metab_gene_hallmarks
network_combined$mor <- 1
network_combined$term <- gsub("HALLMARK_","", network_combined$term)
network_combined$term <- gsub("_", " ", network_combined$term)
# network separated
network_met <- network_combined[which(grepl("HMDB", network_combined$feature) == T),]
network_prot <- network_combined[which(grepl("HMDB", network_combined$feature) == F),]
# input for pathway enrichment analysis
logFC_PEA_prot_MTBE_z <- readRDS("../results/single_patient/logFC_PEA_prot_MTBE_z.Rda")
logFC_PEA_prot_autoSP3_z <- readRDS("../results/single_patient/logFC_PEA_prot_autoSP3_z.Rda")
logFC_PEA_metab_z <- readRDS("../results/single_patient/logFC_PEA_metab_z.Rda")
Biocrates_metabolite_identifier <- read_excel("../support/Biocrates_metabolite_identifier.xlsx")
Biocrates_metabolite_identifier$feature <- gsub("[()/: -]",".",Biocrates_metabolite_identifier$feature)
# network combined
getwd()
combined_metab_gene_hallmarks <- read_csv("upport/combined_metab_gene_hallmarks.csv")
combined_metab_gene_hallmarks <- read_csv("support/combined_metab_gene_hallmarks.csv")
# network combined
combined_metab_gene_hallmarks <- read_csv("support/combined_metab_gene_hallmarks.csv")
network_combined <- combined_metab_gene_hallmarks
network_combined$mor <- 1
network_combined$term <- gsub("HALLMARK_","", network_combined$term)
network_combined$term <- gsub("_", " ", network_combined$term)
# network separated
network_met <- network_combined[which(grepl("HMDB", network_combined$feature) == T),]
network_prot <- network_combined[which(grepl("HMDB", network_combined$feature) == F),]
# input for pathway enrichment analysis
logFC_PEA_prot_MTBE_z <- readRDS("results/single_patient/logFC_PEA_prot_MTBE_z.Rda")
logFC_PEA_prot_autoSP3_z <- readRDS("results/single_patient/logFC_PEA_prot_autoSP3_z.Rda")
logFC_PEA_metab_z <- readRDS("results/single_patient/logFC_PEA_metab_z.Rda")
Biocrates_metabolite_identifier <- read_excel("support/Biocrates_metabolite_identifier.xlsx")
Biocrates_metabolite_identifier$feature <- gsub("[()/: -]",".",Biocrates_metabolite_identifier$feature)
# network combined
combined_metab_gene_hallmarks <- read_csv("support/combined_metab_gene_hallmarks.csv")
network_combined <- combined_metab_gene_hallmarks
network_combined$mor <- 1
network_combined$term <- gsub("HALLMARK_","", network_combined$term)
network_combined$term <- gsub("_", " ", network_combined$term)
# network separated
network_met <- network_combined[which(grepl("HMDB", network_combined$feature) == T),]
network_prot <- network_combined[which(grepl("HMDB", network_combined$feature) == F),]
# input for pathway enrichment analysis
logFC_PEA_prot_MTBE_z <- readRDS("results/single_patient/logFC_PEA_prot_MTBE_z.Rda")
logFC_PEA_prot_autoSP3_z <- readRDS("results/single_patient/logFC_PEA_prot_autoSP3_z.Rda")
logFC_PEA_metab_z <- readRDS("results/single_patient/logFC_PEA_metab_z.Rda")
Biocrates_metabolite_identifier <- read_excel("support/Biocrates_metabolite_identifier.xlsx")
Biocrates_metabolite_identifier$feature <- gsub("[()/: -]",".",Biocrates_metabolite_identifier$feature)
# transform metab from ID to HMDB numbers
logFC_PEA_metab_z <- logFC_PEA_metab_z %>%
rownames_to_column(var= "ID")
logFC_PEA_metab_z <- merge(logFC_PEA_metab_z, Biocrates_metabolite_identifier, by.x = "ID", by.y = "feature")
logFC_PEA_metab_z <- logFC_PEA_metab_z[,-c(6:8)]
logFC_PEA_metab_z <- logFC_PEA_metab_z %>%
mutate(HMDB = strsplit(as.character(HMDB), "/")) %>%
unnest(HMDB) %>%
filter(HMDB != "") %>%
unique()
# average if metabolites have same HMDB number
# so there is only one HMDB as input
logFC_PEA_metab_z <- logFC_PEA_metab_z[,c(6,2:5)]
logFC_PEA_metab_z <- logFC_PEA_metab_z %>%
group_by(HMDB) %>%
summarise_each(funs(mean))
# now rownames can be annotated
logFC_PEA_metab_z <- logFC_PEA_metab_z %>%
column_to_rownames("HMDB")
# NAs needs to be removed and input in matrix form
logFC_PEA_metab_z <- logFC_PEA_metab_z %>%
drop_na() %>%
as.matrix()
colnames(logFC_PEA_metab_z) <- paste("Patient", colnames(logFC_PEA_metab_z), sep ="_")
logFC_PEA_prot_MTBE_z <- logFC_PEA_prot_MTBE_z %>%
drop_na() %>%
as.matrix()
colnames(logFC_PEA_prot_MTBE_z) <- paste("Patient", colnames(logFC_PEA_prot_MTBE_z), sep ="_")
logFC_PEA_prot_autoSP3_z <- logFC_PEA_prot_autoSP3_z %>%
drop_na() %>%
as.matrix()
colnames(logFC_PEA_prot_autoSP3_z) <- paste("Patient", colnames(logFC_PEA_prot_autoSP3_z), sep ="_")
# now the inputs are all in the right format
## combined prot_MTBE with metab and prot_autoSP3 with metab
combined_MTBE <- rbind(logFC_PEA_metab_z, logFC_PEA_prot_MTBE_z)
combined_autoSP3 <- rbind(logFC_PEA_metab_z, logFC_PEA_prot_autoSP3_z)
# MTBE
norm_wmean_combined_MTBE <- run_wmean(mat = combined_MTBE, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_combined_MTBE <- norm_wmean_combined_MTBE %>%
filter(statistic == 'norm_wmean')
# autoSP3
norm_wmean_combined_autoSP3 <- run_wmean(mat = combined_autoSP3, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_combined_autoSP3 <- norm_wmean_combined_autoSP3 %>%
filter(statistic == 'norm_wmean')
# create matrix with pathway as rows and samples in columns
corr_matrix_MTBE <- norm_wmean_combined_MTBE[,c(3,2,4)]
corr_matrix_MTBE <- pivot_wider(corr_matrix_MTBE, names_from = condition, values_from = score )
corr_matrix_MTBE <- corr_matrix_MTBE %>%
column_to_rownames("source")
corr_matrix_autoSP3 <- norm_wmean_combined_autoSP3[,c(3,2,4)]
corr_matrix_autoSP3 <- pivot_wider(corr_matrix_autoSP3, names_from = condition, values_from = score )
corr_matrix_autoSP3 <- corr_matrix_autoSP3 %>%
column_to_rownames("source")
corr_integrated <- diag(cor(corr_matrix_MTBE, corr_matrix_autoSP3, method= "pearson"))
## correlation sample wise
corr_integrated
mean_corr_integrated <- mean(corr_integrated)
mean_corr_integrated
# metab
norm_wmean_metab_sep <- run_wmean(mat = logFC_PEA_metab_z, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_metab_sep <- norm_wmean_metab_sep %>%
filter(statistic == 'norm_wmean')
# prot
<<<<<<< HEAD
prot_cosmos <- as.data.frame(matrix(NA, ncol = 2, nrow = dim(logFC_proteomics_TUvsNG)[1]))
colnames(prot_cosmos) <- c("ID", "logFC_z")
prot_cosmos$ID <- logFC_proteomics_TUvsNG[,1]
prot_cosmos$logFC_z<- logFC_proteomics_TUvsNG[,which(colnames(logFC_proteomics_TUvsNG) == patient)]
# filter top 100 prot
prot_cosmos <- prot_cosmos %>%
arrange(desc(abs(logFC_z))) %>%
slice(1:100)
Biocrates_metabolite_identifier <- read_excel("support/Biocrates_metabolite_identifier.xlsx")
Biocrates_metabolite_identifier$feature <- gsub("[()/: -]",".",Biocrates_metabolite_identifier$feature)
met_cosmos <- merge(met_cosmos, Biocrates_metabolite_identifier, by.x = "ID", by.y = "feature")
met_cosmos <- met_cosmos %>%
mutate(HMDB = strsplit(as.character(HMDB), "/")) %>%
unnest(HMDB) %>%
filter(HMDB != "")
mapping <- met_cosmos[,c(1,6)]
cosmos_met_input <- unlist(met_cosmos$logFC_z)
names(cosmos_met_input) <- met_cosmos$HMDB
cosmos_met_input <- prepare_metab_inputs(cosmos_met_input, c("c","m"))
cosmos_prot_input <- unlist(prot_cosmos$logFC_z)
names(cosmos_prot_input) <- prot_cosmos$ID
#In order to adapt options to users specification we can load them into a variable
#that will then be passed to preprocess_COSMOS_signaling_to_metabolism CARNIVAL_options parameter
my_options <- default_CARNIVAL_options(solver = "cplex")
#Here the user should provide a path to its CPLEX executable (only cplex at the moment, other solvers will be documented soon !)
# my_options$solverPath <- "~/Documents/cplex" #or cbc solver executable
my_options$solverPath <- "cplex/cplex.exe"
# my_options$solverPath <- "cbc/cbc-osx/cbc" #or cbc solver executable
my_options$solver <- "cplex" #or cbc
# my_options$solver <- "cbc"
my_options$timelimit <- 1800
my_options$mipGAP <- 0.05
my_options$threads <- 6
metab_input <- cosmosR:::filter_input_nodes_not_in_pkn(cosmos_met_input, meta_network)
sig_input <- cosmosR:::filter_input_nodes_not_in_pkn(cosmos_prot_input, meta_network)
test_for <- preprocess_COSMOS_signaling_to_metabolism(meta_network = meta_network,
signaling_data = sig_input,
metabolic_data = metab_input,
maximum_network_depth = 4,
CARNIVAL_options = my_options)
test_for <- preprocess_COSMOS_signaling_to_metabolism(meta_network = meta_network,
signaling_data = sig_input,
metabolic_data = metab_input,
maximum_network_depth = 3,
CARNIVAL_options = my_options)
test_for <- preprocess_COSMOS_signaling_to_metabolism(meta_network = meta_network,
signaling_data = sig_input,
metabolic_data = metab_input,
maximum_network_depth = 4,
CARNIVAL_options = my_options)
my_options$timelimit <- 600
test_result_for <- run_COSMOS_signaling_to_metabolism(data = test_for,
CARNIVAL_options = my_options)
View(metabolomics_DE_t)
View(metabolomics_DE_t)
View(metabolomics_DE_t)
raw_metab <- readRDS("data/SummarizedExperiment_extraction_method_cohort_metabolomics.RDS")
raw_prot <- readRDS("data/SummarizedExperiment_extraction_method_cohort_proteomics.RDS")
# annotation tumor and healthy tissue
# raw_metab
metab_count <- as.data.frame(raw_metab@assays@data@listData[[1]])
colnames(metab_count) <- raw_metab@colData@listData[["Sample.Description"]]
View(raw_metab)
View(metab_count)
prot_count <- as.data.frame(raw_prot@assays@data@listData[[1]])
colnames(prot_count) <- raw_prot@colData@listData[["Pseudonym"]]
prot_count <- tibble::rownames_to_column(prot_count, "ID")
View(raw_prot)
View(prot_count)
View(metab_count)
View(prot_count)
prot_count <- prot_count %>%
mutate(ID = strsplit(as.character(ID), ";")) %>%
unnest(ID) %>%
filter(ID != "")
prot_count <- prot_count[prot_count$ID != "NA",]
prot_count <- unique(prot_count)
library(readr)
library(readxl)
library(cosmosR)
library(decoupleR)
library(SummarizedExperiment)
library(dplyr)
library(tidyr)
library(tibble)
library(readr)
library(readxl)
library(cosmosR)
library(decoupleR)
library(SummarizedExperiment)
library(dplyr)
library(tidyr)
library(tibble)
## Data is already processed -> log2() transformation
raw_metab <- readRDS("data/SummarizedExperiment_extraction_method_cohort_metabolomics.RDS")
raw_prot <- readRDS("data/SummarizedExperiment_extraction_method_cohort_proteomics.RDS")
# annotation tumor and healthy tissue
# raw_metab
metab_count <- as.data.frame(raw_metab@assays@data@listData[[1]])
colnames(metab_count) <- raw_metab@colData@listData[["Sample.Description"]]
metab_count <- unique(metab_count)
metabolomics_TUvsNG <- as.data.frame(metab_count)
# raw_prot
prot_count <- as.data.frame(raw_prot@assays@data@listData[[1]])
colnames(prot_count) <- raw_prot@colData@listData[["Pseudonym"]]
prot_count <- tibble::rownames_to_column(prot_count, "ID")
prot_count <- prot_count %>%
mutate(ID = strsplit(as.character(ID), ";")) %>%
unnest(ID) %>%
filter(ID != "")
prot_count <- prot_count[prot_count$ID != "NA",]
prot_count <- unique(prot_count)
proteomics_TUvsNG <- as.data.frame(prot_count[,-1])
rownames(proteomics_TUvsNG) <- prot_count$ID
# additionally differentiate between autoSP3 and MTBE
autoSP3orMTBE <- raw_prot@colData@listData[["Processing"]]
sum(autoSP3orMTBE == "MTBE_SP3")
# first 18 are MTBE_SP3, autoSP3 are only
View(metabolomics_TUvsNG)
View(metab_count)
View(metabolomics_TUvsNG)
View(metab_count)
View(metabolomics_TUvsNG)
=======
norm_wmean_prot_MTBE_sep <- run_wmean(mat = logFC_PEA_prot_MTBE_z, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_prot_MTBE_sep <- norm_wmean_prot_MTBE_sep %>%
filter(statistic == 'norm_wmean')
norm_wmean_prot_autoSP3_sep <- run_wmean(mat = logFC_PEA_prot_autoSP3_z, net = network_combined, .source = "term", .target = "feature", .mor="mor")
norm_wmean_prot_autoSP3_sep <- norm_wmean_prot_autoSP3_sep %>%
filter(statistic == 'norm_wmean')
corr_matrix_MTBE_sep <- norm_wmean_prot_MTBE_sep[,c(3,2,4)]
corr_matrix_MTBE_sep <- pivot_wider(corr_matrix_MTBE_sep, names_from = condition, values_from = score )
corr_matrix_MTBE_sep <- corr_matrix_MTBE_sep %>%
column_to_rownames("source")
corr_matrix_autoSP3_sep <- norm_wmean_prot_autoSP3_sep[,c(3,2,4)]
corr_matrix_autoSP3_sep <- pivot_wider(corr_matrix_autoSP3_sep, names_from = condition, values_from = score )
corr_matrix_autoSP3_sep <- corr_matrix_autoSP3_sep %>%
column_to_rownames("source")
corr_proteomics <- diag(cor(corr_matrix_MTBE_sep, corr_matrix_autoSP3_sep, method= "pearson"))
## correlation sample wise
corr_proteomics
mean_corr_proteomics <- mean(corr_proteomics)
mean_corr_proteomics
View(corr_matrix_autoSP3_sep)
matrix_metab <- norm_wmean_metab_sep[,c(3,2,4)]
matrix_metab <- pivot_wider(matrix_metab, names_from = condition, values_from = score )
matrix_MTBE <- norm_wmean_prot_MTBE_sep[,c(3,2,4)]
matrix_MTBE <- pivot_wider(matrix_MTBE, names_from = condition, values_from = score )
matrix_autoSP3 <- norm_wmean_prot_autoSP3_sep[,c(3,2,4)]
matrix_autoSP3 <- pivot_wider(matrix_autoSP3, names_from = condition, values_from = score )
# filtering of same pathways between metab and MTBE, autoSP3 respectively
subset_corr <- which(matrix_metab$source %in% matrix_MTBE$source)
source_subset <- matrix_metab$source[subset_corr]
matrix_metab <- matrix_metab[subset_corr,]
matrix_metab <- matrix_metab %>%
column_to_rownames("source")
matrix_MTBE <- matrix_MTBE[which(matrix_MTBE$source %in% source_subset),]
matrix_MTBE <- matrix_MTBE %>%
column_to_rownames("source")
matrix_autoSP3 <- matrix_autoSP3[which(matrix_autoSP3$source %in% source_subset),]
matrix_autoSP3 <- matrix_autoSP3 %>%
column_to_rownames("source")
# average metab and proteomics (prot1, prot2 respectively)
corr_matrix_MTBE_metab <- list(matrix_metab, matrix_MTBE)
corr_matrix_MTBE_metab_avg <- Reduce("+",corr_matrix_MTBE_metab)/length(corr_matrix_MTBE_metab)
corr_matrix_autoSP3_metab <- list(matrix_metab, matrix_autoSP3)
corr_matrix_autoSP3_metab_avg <- Reduce("+",corr_matrix_autoSP3_metab)/length(corr_matrix_autoSP3_metab)
corr_integrated_average <- diag(cor(corr_matrix_MTBE_metab_avg, corr_matrix_autoSP3_metab_avg, method ="pearson"))
corr_integrated_average
mean_corr_integrated_average<- mean(corr_integrated_average)
mean_corr_integrated_average
ph_corr <- matrix(NA, ncol = 3, nrow=5)
colnames(ph_corr) <- c("Proteomics", "Integrated", "Integrated Average")
rownames(ph_corr) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr[c(1:4),1] <- corr_proteomics
ph_corr[5,1] <- mean_corr_proteomics
ph_corr[c(1:4),2] <- corr_integrated
ph_corr[5,2] <- mean_corr_integrated
ph_corr[c(1:4),3] <- corr_integrated_average
ph_corr[5,3] <- mean_corr_integrated_average
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
pdf("pHeatmap_pathway_enrichment_scores_correlation.pdf")
heatmap_plot
dev.off()
corr_proteomics
# metab and MTBE
corr_metab_MTBE <- diag(cor(matrix_metab, matrix_MTBE, method= "pearson"))
## correlation sample wise
corr_metab_MTBE
mean_corr_metab_MTBE <- mean(corr_metab_MTBE)
mean_corr_metab_MTBE
# metab and autoSP3
corr_metab_autoSP3 <- diag(cor(matrix_metab, matrix_autoSP3, method= "pearson"))
## correlation sample wise
corr_metab_autoSP3
mean_corr_metab_autoSP3 <- mean(corr_metab_autoSP3)
mean_corr_metab_autoSP3
corr_metab_MTBE
ph_corr_m <- matrix(NA, ncol = 2, nrow=5)
colnames(ph_corr_m) <- c("Metab and MTBE", "Metab and autoSP3")
rownames(ph_corr_m) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr_m[c(1:4),1] <- corr_metab_MTBE
ph_corr_m[5,1] <- mean_corr_metab_MTBE
ph_corr_m[c(1:4),2] <- corr_metab_autoSP3
ph_corr_m[5,2] <- mean_corr_metab_autoSP3
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
ph_corr_m <- matrix(NA, ncol = 2, nrow=5)
colnames(ph_corr_m) <- c("Metab and MTBE", "Metab and autoSP3")
rownames(ph_corr_m) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr_m[c(1:4),1] <- corr_metab_MTBE
ph_corr_m[5,1] <- mean_corr_metab_MTBE
ph_corr_m[c(1:4),2] <- corr_metab_autoSP3
ph_corr_m[5,2] <- mean_corr_metab_autoSP3
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
cols <- colorRampPalette(c("white","#7285A5"))(100)
cols
breaks = seq(0, 100 1)
breaks = seq(0, 100, 1)
breaks
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks = breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), breaks = breaks, fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
breaks <- seq(0, 100, 1)
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), breaks = breaks, fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks = breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
ph_corr_m <- matrix(NA, ncol = 2, nrow=5)
colnames(ph_corr_m) <- c("Metab and MTBE", "Metab and autoSP3")
rownames(ph_corr_m) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr_m[c(1:4),1] <- corr_metab_MTBE
ph_corr_m[5,1] <- mean_corr_metab_MTBE
ph_corr_m[c(1:4),2] <- corr_metab_autoSP3
ph_corr_m[5,2] <- mean_corr_metab_autoSP3
cols <- colorRampPalette(c("white","#7285A5"))(100)
breaks <- seq(0, 100, 1)
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks = breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
ph_corr <- matrix(NA, ncol = 3, nrow=5)
colnames(ph_corr) <- c("Proteomics", "Integrated", "Integrated Average")
rownames(ph_corr) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr[c(1:4),1] <- corr_proteomics
ph_corr[5,1] <- mean_corr_proteomics
ph_corr[c(1:4),2] <- corr_integrated
ph_corr[5,2] <- mean_corr_integrated
ph_corr[c(1:4),3] <- corr_integrated_average
ph_corr[5,3] <- mean_corr_integrated_average
cols <- colorRampPalette(c("white","#7285A5"))(100)
breaks = seq(0, 100, 1)
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks = breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
pdf("pHeatmap_pathway_enrichment_scores_correlation.pdf")
heatmap_plot
dev.off()
ph_corr <- matrix(NA, ncol = 3, nrow=5)
colnames(ph_corr) <- c("Proteomics", "Integrated", "Integrated Average")
rownames(ph_corr) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr[c(1:4),1] <- corr_proteomics
ph_corr[5,1] <- mean_corr_proteomics
ph_corr[c(1:4),2] <- corr_integrated
ph_corr[5,2] <- mean_corr_integrated
ph_corr[c(1:4),3] <- corr_integrated_average
ph_corr[5,3] <- mean_corr_integrated_average
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
pdf("pHeatmap_pathway_enrichment_scores_corr_proteomics.pdf")
heatmap_plot
dev.off()
# metab and MTBE
corr_metab_MTBE <- diag(cor(matrix_metab, matrix_MTBE, method= "pearson"))
## correlation sample wise
corr_metab_MTBE
mean_corr_metab_MTBE <- mean(corr_metab_MTBE)
mean_corr_metab_MTBE
# metab and autoSP3
corr_metab_autoSP3 <- diag(cor(matrix_metab, matrix_autoSP3, method= "pearson"))
## correlation sample wise
corr_metab_autoSP3
mean_corr_metab_autoSP3 <- mean(corr_metab_autoSP3)
mean_corr_metab_autoSP3
ph_corr_m <- matrix(NA, ncol = 2, nrow=5)
colnames(ph_corr_m) <- c("Metab and MTBE", "Metab and autoSP3")
rownames(ph_corr_m) <- c("Patient_K6R512", "Patient_KWF2HW", "Patient_ZQ021J", "Patient_ZT9UTK", "Average")
ph_corr_m[c(1:4),1] <- corr_metab_MTBE
ph_corr_m[5,1] <- mean_corr_metab_MTBE
ph_corr_m[c(1:4),2] <- corr_metab_autoSP3
ph_corr_m[5,2] <- mean_corr_metab_autoSP3
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols,column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
pdf("pHeatmap_pathway_enrichment_scores_corr_metab_and_proteomics.pdf")
heatmap_plot_m
dev.off()
heatmap_plot_m
breaks <- c(seq(0, 100, by=1))
breals
breaks
cols <- c(colorRampPalette(c("white","#7285A5"))((length(my.breaks))))
cols <- c(colorRampPalette(c("white","#7285A5"))((length(breaks))))
cols
breaks <- c(seq(0, 99, by=1))
breaks
breaks <- c(seq(1,100, by=1))
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks= breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
breaks <- c(seq(0,0.99, by=.1))
cols <- c(colorRampPalette(c("white","#7285A5"))((length(breaks))))
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks= breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
breaks <- c(seq(0,0.99, by=.1))
cols <- c(colorRampPalette(c("white","#7285A5"))((length(breaks))))
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks = breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
breaks <- c(seq(0,0.99, by=.1))
cols <- c(colorRampPalette(c("white","#7285A5"))((length(breaks))))
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, breaks= breaks, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
#breaks <- c(seq(0,0.99, by=.1))
cols <- c(colorRampPalette(c("white","#7285A5"))((100 #length(breaks))))
#breaks <- c(seq(0,0.99, by=.1))
cols <- c(colorRampPalette(c("white","#7285A5"))(100) # or use length(breaks)
#breaks <- c(seq(0,0.99, by=.1))
cols <- colorRampPalette(c("white","#7285A5"))(100) # or use length(breaks)
heatmap_plot_m <- ComplexHeatmap::pheatmap(ph_corr_m, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot_m
pdf("pHeatmap_pathway_enrichment_scores_corr_metab_and_proteomics.pdf")
heatmap_plot_m
dev.off()
#breaks <- c(seq(0,0.99, by=.1))
cols <- colorRampPalette(c("white","#7285A5"))(100)
heatmap_plot <- ComplexHeatmap::pheatmap(ph_corr, display_numbers = T, cluster_cols = F,  cluster_rows=F, fontsize_number = 14, treeheight_row = 0, color = cols, column_names_side = c("top"), fontsize = 12, angle_col = c("0"), annotation_legend =T)
heatmap_plot
pdf("pHeatmap_pathway_enrichment_scores_corr_proteomics.pdf")
heatmap_plot
dev.off()